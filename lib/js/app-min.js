$(document).ready(function(){cart=[],localStorage.getItem("cartItems")||localStorage.setItem("cartItems","[]"),cart.push(localStorage.getItem("cartItems")),$(".searchbtn").on("click",function(){$(".searchbox").fadeToggle("slow")}),renderItems=function(t){var a=t.price;const e=a-a*t.discount/100;var c='<div class="product-container" data-price='+e+" data-discount="+t.discount+'><div class="product-img"><img src='+t.img_url+'></div><span class="product_name">'+t.name+'</span><span class="discount-price">&#8377;'+e+'</span><span class="price">'+a+'</span><span class="dispsercentage">'+t.discount+'%off</span><div class="cart-button"><button class="cartbtn" data-item='+t.id+">Add to cart</button></div></div>";$(".itemsList").append(c)},$.ajax({url:"https://api.myjson.com/bins/qzuzi",success:function(t){t.forEach(function(t){renderItems(t)}),localStorage.setItem("items",JSON.stringify(t))},error:function(){console.log("Coudnt conect to source")}}),$(document).on("click",".cartbtn",function(){var t=$(this).attr("data-item");addToCart(t)}),$(document).on("click",".product-inc",function(){var t=$(this).attr("data-itemid"),a=parseInt($(this).parent().find(".product-qty").text())+1;$(this).parent().find(".product-qty").text(a),addToCart(t),calculateTotal()}),$(document).on("click",".product-dec",function(){var t=$(this).attr("data-itemid"),a=parseInt($(this).parent().find(".product-qty").text())-1;$(this).parent().find(".product-qty").text(a),a<1&&removeItemFromCart(t);for(var e=JSON.parse(localStorage.getItem("cartItems")),c=0;c<e.length;c++)e[c].itemId==t&&e[c].count--;localStorage.setItem("cartItems",JSON.stringify(e)),calculateTotal()}),$(document).on("click",".removeFromCart",function(){var t=$(this).attr("data-itemid");removeItemFromCart(t)}),removeItemFromCart=function(t){for(var a=JSON.parse(localStorage.getItem("cartItems")),e=0;e<a.length;e++)a[e].itemId==t&&a.splice(e,1);localStorage.setItem("cartItems",JSON.stringify(a)),window.location.reload(),calculateTotal()},addToCart=function(t){var a={itemId:t,count:1};ifitemExist(t)||cart.push(a),localStorage.setItem("cartItems",JSON.stringify(cart)),updateCarticon()},ifitemExist=function(t){var a=!1;if(null==cart)a=!1;else for(var e=0;e<cart.length;e++)cart[e].itemId===t&&(cart[e].count=cart[e].count+1,a=!0);return a},showCartItems=function(){var t=JSON.parse(localStorage.getItem("cartItems")),a=JSON.parse(localStorage.getItem("items"));for(item in a)for(cartitem in t)if(a[item].id==t[cartitem].itemId){var e=a[item].price,c=a[item].discount,r=e-a[item].price*c/100;$(".cartItems").append('<div class="itemcard"><img src='+a[item].img_url+'><span class="itemname">'+a[item].name+'</span><span class="pricespec"><span class="discountprice">&#8377;'+r+'</span><span class="price">&#8377;'+e+'</span><span class="discount">'+c+'% off</span></span><div class="product-controls"><span class="product-dec" data-itemid='+t[cartitem].itemId+'><i class="fa fa-minus-circle"></i></span><span class="product-qty">'+t[cartitem].count+'</span><span class="product-inc" data-itemid='+t[cartitem].itemId+'><i class="fa fa-plus-circle"></i></span></div><span class="removeFromCart" data-itemid='+a[item].id+">Remove</span></div></div>")}},showCartItems(),calculateTotal=function(){$(".billdata table").empty(),$(".totalBill").empty();var t=JSON.parse(localStorage.getItem("cartItems")),a=JSON.parse(localStorage.getItem("items")),e=0;for(item in a)for(cartitem in t)if(a[item].id==t[cartitem].itemId){var c=a[item].price,r=a[item].discount,i=c-a[item].price*r/100;e+=i*t[cartitem].count,$(".billdata table").append("<tr><td>"+a[item].name+"(X"+t[cartitem].count+" Qty)</td><td>&#8377;"+i+"</td></tr>")}$(".totalBill").append('<span>Total Payable</span><span class="payable">&#8377;'+e+"</span>")},calculateTotal(),updateCarticon=function(){var t=0,a=JSON.parse(localStorage.getItem("cartItems"));if(a)for(var e=0;e<a.length;e++)t+=a[e].count;$(".cartcount").text(t),cart=JSON.parse(localStorage.getItem("cartItems"))},$(".sort_option").click(function(){$(this).parent().find(".active").removeClass("active"),$(this).addClass("active");var t=$(this).attr("data-sort");sortItems(t)}),$(".mobile-sort").click(function(){$(".modal-overlay,.messagePop").fadeIn()}),$(".cancelsort").click(function(){$(".modal-overlay,.messagePop").fadeOut()}),$(".applysort").click(function(){var t=document.querySelector('input[name="filter"]:checked').value;$(".modal-overlay,.messagePop").fadeOut(),sortItems(t)}),updateCarticon(),sortItems=function(t){var a;"highlow"==t&&((a=$(".product-container")).sort(function(t,a){return $(a).data("price")-$(t).data("price")}),$(".itemsList").append(a));"lowhigh"==t&&((a=$(".product-container")).sort(function(t,a){return $(t).data("price")-$(a).data("price")}),$(".itemsList").append(a));"discount"==t&&((a=$(".product-container")).sort(function(t,a){return $(t).data("discount")-$(a).data("discount")}),$(".itemsList").append(a))}});